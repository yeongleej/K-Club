# K-Club
졸업 설계 중간발표 정리
이지영
Django Project
Django 란?
• Django 는 파이썬으로 제작된 웹 프레임워크
▪ 프레임워크(Framework) : 어플리케이션을 개발하기 위해 필요한
기본적인 클래스와 라이브러리등이 모두 포함되어 있는 환경
▪ 프레임워크 VS 라이브러리
① 라이브러리는 내가 원하는 시점에 라이브러리를 호출해서
사용 => 코드(라이브러리()), 코드에 라이브러리가
포함되어있는 형태
② 프레임워크는 프레임워크 속에서 코드를 써 내려가는 형태. 
즉, 프레임워크에게 주도권이 있기 때문에 프레임워크의
룰(가이드라인)을 절대적으로 따라야함.
▪ 대표적인 Django 로 만든 서비스 : 인스타그램, 요기요, 헤이딜러 등
Django 특징
1. MVC 패턴 기반의 MVT
o MVT(Model View Template, 모델-뷰-템플릿)패턴을 사용
1) 이는 MVC(Model View Controller) 패턴의 수정 버전
2) MVC : 모델-뷰-컨트롤러로, 모델은 소프트웨어 내에서
데이터를 의미하고, 뷰는 사용자에게 보이는 화면 내용을
의마하며 컨트롤러는 모델과 뷰의 상호작용을 관리
3) 예) 사용자의 입력이 컨트롤러로 들어오면 컨트롤러는
모델에서 데이터를 불러오고, 해당 데이터를 뷰를 통해
화면으로 출력
4) 모델, 뷰, 컨트롤러가 기능별로 독립적으로 분리되어 있어서
여러 명의 개발자가 동시에 각각의 기능을 개발할 수 있고, 
일부 기능이 추가될 경우도 기존의 구성 요소를 재사용 가능.
o 즉, Django 의 MVT 의 View 는 컨트롤러, Template 은 뷰의 역할 : 
장고에서 View 는 데이터를 가져오고 변형하는 컴포넌트인 반면에, 
Template 은 데이터를 사용자에게 보여주는 뷰
o 흐름
1) 클라이언트로부터 요청을 받으면 URLConf 를 이용하여
ULR 을 분석한다.
0. URLConf(URL Configuration)은 장고에서 URL 과
일치하는 뷰를 찾기 위한 패턴들의 집합. 즉, 어떤
URL 요청이 들어오면 어떤 뷰 함수를 실행시킬지
정의하는 단계.
2) URL 분석 결과를 통해 해당 URL 에 대한 처리를 담당할 뷰를
결정한다.
3) 뷰는 자신의 로직을 실행하면서 만일 데이터베이스 처리가
필요하면 모델을 통해 처리하고 그 결과를 반환 받는다.
4) 뷰는 자신의 로직 처리가 끝나면 템플릿을 사용하여
클라이언트에게 전송할 HTML 파일을 생성한다.
5) 뷰는 최종 결과로 HTML 파일을 클라이언트에게 보내
응답한다.
2. 객체 관계 매핑(ORM, Object Relational Mapping)
o ORM 은 객체와 관계형 DB 를 연결해주는 개념
o 즉, 생성한 클래스(객체)를 SQL 문으로 자동 변환하여 데이터를
다루는 것
o ORM 기능을 통해 다양한 데이터베이스 시스템을 지원하고 있으며, 
이미 구축한 데이터베이스 시스템을 다른 데이터베이스로 변경하는
경우에도 설정을 조금만 변경하면 가능하도록 쉽고 편리함.
3. 자동으로 구성되는 관리자 화면
o 장고는 웹 서버의 콘텐츠, 즉 데이터베이스에 대한 관리 기능을
위해 프로젝트를 시작하는 시점에 기본 기능으로 관리자 화면을
제공
o 관리자 화면을 통해 어플리케이션에서 사용하는 데이터들을 쉽게
생성하거나 변경할 수 있으며 개발자가 별도로 관리 기능을 개발할
필요 없음.
4. 자체 템플릿 지원
o 장고는 내부적으로 확장이 가능하고 디자인이 쉬운 강력한 템플릿
시스템을 갖고 있음.
o 이를 통해 화면 디자인과 로직에 대한 코딩을 분리하여 독립적으로
개발 진행이 가능
o 장고의 템플릿 시스템은 HTML 과 같은 텍스트형 언어를 쉽게 다룰
수 있도록 개발됨.
5. 소스코드의 변경사항 자동 반영
o 장고에서는 * .py 파일의 변경 여부를 감시하고 있다가 변경되면
실행 파일에 변경 내역을 자동으로 반영해줌.
o 때문에 장고 테스트용 웹 서버를 실행 중인 상태에서 소스 파일을
수정하더라도 웹 서버를 다시 시작할 필요없이 자동 업데이트
Django 프로젝트 구조
• django_project: 프로젝트 루트(Project Root) => 장고 프로젝트의 모든
파일이 담겨 있는 최상위 디렉토리
• manage.py: 프로젝트의 매니저 역할, 장고 프로젝트 관리를 위한 명령어
지원, 앱(App) 생성, 데이터베이스 관련 명령, 개발 서버 실행 등을 수행
• db.sqlite3: 프로젝트 데이터베이스 파일
• __init__.py: 해당 파일이 있는 디렉토리가 파이썬 패키지임을 알려주는
파일, pyhton3.3 이상부터는 없어도 되지만, 하위버전과 호환을 위해
적어주는 것이 좋음.
• settings.py: 프로젝트 설정 파일, 시간대 설정, 데이터베이스 설정, 여러
경로 설정 등
• urls.py : URL 연결 역할로 url 을 보고 알맞은 페이지로 연결해 주는 역할
• wsgi.py: webserver gateway interface, 웹 서버와 파이썬 어플리케이션인
django 가 소통하는데 필요한 프로토콜
K-Club 프로젝트 구조
• club_project : 프로젝트 루트
• main : 메인 페이지 앱
• account : 사용자 계정 관리 앱
▪ 로그인 / 회원가입 / 마이페이지 기능
• chat : 실시간 채팅 앱
▪ 채팅방 개설 / 채팅방 참가 / 실시간 채팅 기능
• club : 동아리 앱
▪ 동아리 리스트 출력 / 동아리 정보 출력 / 동아리 가입 및 요청
승인 / 동아리 생성 / 동아리 게시판 기능
• 챗봇 앱 (추후 추가 예정)
• static : 프로젝트에 이미 저장되어져 있는 파일, 개발할 때 이미
준비되어진 파일
• media : 웹 서비스 이용자들이 업로드하는 파일
K-Club 데이터베이스
• 사용 DB => django 내장 데이터베이스 Sqlite3
로그인 기능
• 세션(Session)
▪ 클라이언트가 요청을 보내면 서버는 응답에 cookie 를 header 
정보에 함께 보낸다. 쿠키는 키값을 가지고 있다. 그 키값을 서버는
데이터베이스에 저장한다. 클라이언트는 마찬가지로 쿠키 저장소에
할당된 키값을 저장하는데 웹사이트별로 저장을 한다. 한 번
저장하면 다음 요청부터는 계속해서 쿠키를 같이 보내고 서버는
사용자를 구별할 수 있게 된다.
이메일 인증 기능
• 본교 재학생임을 인증하기 위해 회원가입 시 학교 이메일 인증 서비스를
구현
• SMTP(간이 전자 우편 전송 프로토콜, Simple Mail Transfer Protocol)
▪ 인터넷에서 이메일을 보내기 위해 이용되는 프로토콜
▪ 두 메일 서버 간의 통신을 지원해주는 프로토콜
▪ Django 내장 SMTP 사용
• Django EmailMessage 클래스 사용
▪ 메일 작성 객체 제공
▪ 단일 이메일을 보내기 위한 send() 메소드 제공
• Django SMTP 설정
▪ 사전 설정: IMAP 설정(다른 이메일 클라이언트에서 Gmail 을 사용할
수 있도록 설정)
▪ gmail 의 SMTP 서버를 이용하여 메일을 전송하기 위해 Gmail 계정
설정 : 보안 수준이 낮은 앱의 액세스 허용
① IMAP 사용함 : IMAP 은 인터넷을 통해 메일 서버에 접근하기
위한 프로토콜
② 보안 수준 낮은 앱 허용 : django 서버를 통해 보안수준이
낮은 형태로 접근하기 때문에 해당 설정이 필요
▪ setting.py
① EMAIL_BACKEND : 장고 SMTP 이메일 백엔드 사용
② EMAIL_HOST : 메일 호스트 서버
③ EMAIL_HOST_USER : 사용할 GMAIL 호스트
④ EMAIL_HOST_PASSWORD : 사용할 GMAIL 패스워드
⑤ EMAIL_PORT : 서버 포트
⑥ EMAIL_USE_TLS : TLS 보안 설정
▪ views.py 
o 회원가입 함수에서 인증 메일 토큰 생성 및 이메일
전송
▪ 인증 단계
① 회원가입 시 인증 토큰 생성
② 사용자 인증 페이지로 이동할 수 있는 링크를 포함한 인증
이메일 발송
③ 인증 이메일에서 인증하기 링크 클릭 시 url 에 포함된 사용자
id 와 인증 토큰을 비교해서 인증
④ 정상적인 사용자인 경우 Member 모델의 is_auth 컬럼을
True 로 변경 후 메인화면 출력
⑤ 비정상적인 사용자인 경우 인증실패 화면 표시
▪ 토큰 생성 – tokens.py
▪ 웹 메일 인증 템플릿 생성 – activation_email.html
▪ 인증 활성화 url 추가 –urls.py : 전송된 메일에서 계정 활성화 링크
클릭 시, 인코딩된 사용자 id 와 생성된 토큰이 URL 에 포함되고
이를 views.py 의 계정 활성화 함수로 전달
▪ 계정 활성화 – views.py
Django 웹 소켓 Channels
• 웹 소켓(WebSocket)
▪ 기존 웹 페이지의 브라우저 통신 및 렌더링 방식 : HTTP 요청 및
응답을 이용한 방식, 브라우저를 새로고침하여 전체를 렌더링해서
클라이언트 브라우저에 표현. 즉, 요청이 있어야만 응답을 줌.
▪ 웹 소켓: 클라이언트 브라우저와 웹 서버 사이에서 양방향 메시지
송수진 기술. 양방향 모두 언제든지 요청 가능
• Django Channels 
▪ Channels 란?
▪ 웹 소켓, 채팅 프로토콜, IoT 프로토콜 등을 다루는 HTTP 이상의
기능을 갖춘 프로젝트로서 ASGI 라고 불리는 파이썬을 기반으로
만들어 짐.
▪ ASGI(Async Server Gateway Interface)는 비동기 요청인 웹 소켓을
처리하는 이벤트로서 Connect, Send, Receive, Disconnect 가 있음.
ASGI 는 웹 서버(Web Server)와 장고, 어플리케이션을 연결 해주는
파이썬 표준 API
▪ 즉, 장고는 요청이 들어오면 응답하고 다음 요청을 기다리는
방식(동기식)이므로 이를 양방향 통신 하기위해 비동기 통신을
지원하는 Channels 사용
▪ 웹 소켓이 클라이언트와 서버간의 접속을 유지하는 방법은
“HandShake”이다. HandShaking 과정은 클라이언트는 랜덤한 키
값을 전송하고 서버는 키 값으로 생성된 토큰을 클라이언트에게
응답을 보냄.
▪ Consumer
o django 에서 http 요청을 받을 때, URLConf 를 통해서 view 를
찾아가는 것과 비슷하게 Channels 가 웹 소켓 연결을
받아들일 때, Routing Configuration 을 통해 consumer 를
찾는다. 연결을 통해 오는 이벤트를 다루기 위해 consumer 에
있는 다양한 기능들을 호출함.
o consumer 는 모든 요청을 받아들이는 비동기적인 웹 소켓
소비자 역할. 즉, 메시지를 클라이언트로부터 받아서 그대로
클라이언트에게 전달하는 기능
o
Django Channels
URLConf Routing Configuration
Views consumer
▪ Channels Layer
o communication 시스템의 한 종류. 여러 사람이 소통하는
것을 가능하게 해줌.
o 모든 consumer instance 는 자동적으로 채널 이름이
만들어지고 channel layer 를 통해 소통할 수 있다.
o 두 가지 추상화(abstractions)를 제공
1. Channel : 메시지를 보낼 수 있는 메일박스. 각각의
채널은 이름을 갖는다. 채널의 이름을 가진 누구든지
channel 에 메시지를 보낼 수 있다. (채팅방 입력하고
채팅방 참여)
2. Group : 연관된 채널의 그룹을 의미. 그룹 또한 이름을
가지고 그룹의 이름을 가진 누구든지 그룹에 채널을
삭제 / 추가할 수 있다.
▪ Redis 를 쓰는 이유
▪ Redis 란
o NoSQL 데이터베이스의 하나
o Remote 에 위치한 / 프로세스로 존재하는 / InMemory(메모리 기반의) / 키-값 구조의 관리시스템: 
비관계형이고, 키-값 구조이기 때문에 별도의 쿼리없이
데이터를 간단하게 가져올 수 있음.
o 서비스의 특성이나 상황에 따라 1) 캐시로 사용하거나, 2) 
Persistence Data Storage 로 사용할 수 있다. 
▪ Django Channels 에서 Redis 의 역할 => Channel Layers
o redis 의 주된 목적은 소비자의 서로 다른 인스턴스가 서로
소통하는 데 필요한 정보를 저장하는 것이다.
▪ 채팅 어플 진행 플로우
o 1) 채팅방 이름 입력 시 consumer.py 의 connect()함수를
통해 웹소켓 연결
o 2) 클라이언트가 채팅입력
o 3) 자바스크립트로 처리(새로운 메시지 입력 시,
createMessage 함수를 통해 author, message, room 을
포함한 command 를 작성한 뒤 consumer.py 로 전달)
o 4) consumer.py 의 send_chat_message() 함수에서
async_to_sync() 함수를 통해 orm 을 이용하여 DB 에 접근 및
데이터 저장
▪ WSGI(Web Server Gateway Interface) : 파이썬의 표준 게이트웨이
인터페이스
o 기본적으로 웹 서버 자체는 정적인 페이지 밖에 보여주지
못하고 우리가 인터넷에서 보는 동적인 페이지들은 웹
서버가 전적으로 처리하는 것이 아니라 웹
어플리케이션(장고, 플라스크 등으로 작성된 프로그램)의
도움으로 보게된다.
o 때문에 웹 서버와 웹 어플리케이션이 서로 소통할 수
있어야함. 그러나 Ngnix 등의 웹 서버는 파이썬 코드를
이해하지 못하므로 파이썬 기반 웹 어플리케이션과 소통할
수 없음.
o 1) 클라이언트에서 요청을 보냄
o 2) 웹 서버에서 요청을 받고 이때, 동적인 페이지를
요청했다면 WSGI 서버(미들웨어)를 호출
o 3) WSGI 서버는 WSGI 를 사용하는 웹 어플리케이션(장고)를
호출
o 4) 호출 받은 웹 어플리케이션은 요청에 따라 적절한 처리를
수행
o 5) 수행 결과를 다시 WSGI 서버를 통해 웹 서버로 전달하고,
웹 서버는 최종 응답을 클라이언트에게 보냄.
o 대표적인 WSGI 서버 : uWSGI, mod_wsgi, Gunicorn
▪ 필요 라이브러리
o channels
o channels-redis
K-Club 구현 페이지
▪ 메인 페이지
1. 로그인 전
2. 로그인 후
▪ 회원 가입 페이지
error: 학교 메일 외의 메일 입력 시
▪ 이메일 인증 페이지
▪ 로그인 페이지
error1: 아이디 비밀번호 잘못 입력
error2: 계정 비활성화 상태
▪ 채팅방 입력 페이지
▪ 채팅방 초기 화면
▪ 채팅방에 메시지(채팅 로그)가 있을 경우
